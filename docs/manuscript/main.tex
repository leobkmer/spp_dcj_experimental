% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.21 of 2022/01/12
%
\documentclass[runningheads]{llncs}
%
\input{preamble}
\usepackage[T1]{fontenc}
% T1 fonts will be used to generate the final print and online PDFs,
% so please use T1 fonts in your manuscript whenever possible.
% Other font encondings may result in incorrect characters.
%
\usepackage{graphicx}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following two lines
% to display URLs in blue roman font according to Springer's eBook style:

%\renewcommand\UrlFont{\color{blue}\rmfamily}
%

\begin{document}
%
\title{Reconstructing Rearrangement Phylogenies of Natural Genomes}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Leonard Bohnen\"amper\inst{1}\orcidID{0000-0003-4508-0078} \and
    Jens Stoye \inst{1}\orcidID{0000-0002-4656-7155} \and
    Daniel D\"orr \inst{2}\orcidID{0000-0002-3720-6227}
}
%
\authorrunning{L. Bohnenk\"amper et al.}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{Faculty of Technology and Center for Biotechnology (CeBiTec), Bielefeld University, Germany\\ 
    \email{lbohnenkaemper@techfak.uni-bielefeld.de}, \email{jens.stoye@uni-bielefeld.de}\\
\and
Institute for Medical Biometry and Bioinformatics, Medical Faculty, and Center for Digital Medicine, Heinrich Heine University, Germany\\
\email{daniel.doerr@hhu.de}}

%
\maketitle              % typeset the header of the contribution
%
\begin{abstract}

\input{abstract}


\keywords{genome rearrangement \and ancestral reconstruction \and small parsimony \and integer linear programming \and double-cut-and-join}
\end{abstract}




\section{Introduction}
\section{Background}

\subsection{Preliminaries}
A \emph{phylogeny} $\tree$ is a connected graph with nodes representing \emph{operational taxonomic units} (OTUs). 
Nodes with degree 1 are termed \emph{tips} of the phylogeny.
A \emph{genome scaffold} of an OTU $\A$ is a quintuple $(M \cup \pseudocaps, A, \family, \multi, \w)$ with 
\begin{itemize}
    \item $M$ being the marker set of $\A$ and $\pseudocaps$ its set of telomeres,
    \item $A$ its set of unique adjacencies satisfying 
        \emph{(i)} $\forall g^\et \in \bigcup A$, there exists also extremity $g^\eh \in \bigcup A$ and vice versa, and 
        \emph{(ii)} each telomeric extremity is used only once: $\forall \{X, X'\} \subseteq A$, $X \cap X' \cap \pseudocaps = \emptyset$. 
    \item $\family: M \to \mathbb N$ a function indicating the gene family of each marker of $\A$,
    \item a function $\multi(i) = [a, b]$ that reports for each family $i$ the permitted range $0 \leq a \leq b$ of its copy number, such that each family $F_i = \{m \in M \mid f(m) = i\}$ satisfies $|F_i| = b$, 
    \item and adjacency weight function $\w: A \to \mathbb R$.
\end{itemize}
% \begin{enumerate}
% \end{enumerate}
A genome is a triple $(M \cup \pseudocaps, A, \family)$ for which the following holds true:
\begin{itemize}
    \item The extremities of each marker $m = (m^\et, m^\eh) \in M$ occur in exactly one adjacency, i.e., $|\{ a \in A \mid m^\et \in a\}| = |\{ a \in A \mid m^\eh \in a\}| = 1$,
    \item 
\end{itemize}
Note that a genome is also a scaffold, but the reverse does not hold true in general. 

A genome $A'$ is \emph{$A$-derived} from degenerate genome $A$ (or simply ``derived from $A$'') if $A' \subseteq A$ and $\bigcup A' \setminus \pseudocaps = \bigcup A \setminus \pseudocaps$. 
Conversely, a degenerate genome $A$ is \emph{linearizable} if there exists an $A$-derived genome. 
In fact, many degenerate genomes are not linearizable. 

General notation
\begin{itemize}
    \item 
    \item Weighted multigraph $G = (\vertices, \edges, \w)$ with edge weight function $\w: \edges \to \mathbb R$
\end{itemize}

Paper-specific notation:

\begin{itemize}
    \item Genomic marker 
    \item Furthermore, we use a function $\extf : \extremities \to \{\et, \eh, \circ\}$ to map extremities to their corresponding kind (tail, head or telomere). 
    \item Genome $\X$
    \item \hl{Genome adjacency graph}\todoD{replace with degenerate genome} $\ggraph(\X) = (\vertices, \edges, \family)$ 
    \item 
We model family assignments of marker extremities as a function $\family: \extremities \to \mathbb N$ for which holds true that for any marker $g = \{g^\et, g^\eh\}$, $\family(g^\et) = \family(g^\eh)$.  
Function 
$\minmulti_\X : \mathbb N \to \mathbb N$ reports the minimum multiplicity of a gene family in a given genome $\X$, while $\maxmulti_\X: \mathbb N \to \mathbb N$ reports its maximum multiplicity. 
    \item Multirelational diagram $\mrd$ and \emph{capping-free multi-relational diagram} (CFMRD) $\pcmrd$
\end{itemize}

\begin{itemize}
    \item SPP algoirthms such as 
\end{itemize}

\begin{problem}[Weighted CN-constrained degenerate DCJ indel distance]\label{prb:wdeg_dcj}
    Given a weighting scheme $\w : \extremities \times \extremities \to \mathbb R$, some $\alpha \in [0, 1]$, two linearizable degenerate genomes $\A, \B$ with copy number constraints \hl{XX}\todoD{add data structure} and family assignment $\family$, find $\A$-derived genome $\A'$, $\B$-derived genome $\B'$, and $\family$-derived $\{\A',\B'\}$-resolved family assignment $\family'$ that minimize the linear combination
    $$
    (1-\alpha) \cdot \sum_{X \in \A' \cup \B'} -\w(X) + \alpha \cdot \dist_\DCJid(A', B')\,.
    $$
\end{problem}

\begin{problem}[SPP-DCJ]\label{prb:spp_dcj}
    Given a phylogeny $\tree$ and a set of linearizable degenerate genomes $\A_1, \ldots, \A_k$ corresponding to the node set $V(\tree) = \{\A_1, \ldots, \A_k\}$, find genomes $\A'_1 \subseteq \A_1, \ldots, \A'_k \allowbreak \subseteq \A_k$ that minimize the sum of weighted degenerate DCJ indel distances along the edges of $\tree$. 
\end{problem}

\section{A new Method}
\subsection{Pre-selecting Adjacencies}
\todoD{Describe Process}\subsection{A New ILP Formulation}



The algorithm described in the following operates on two levels: 
on the local level, a genome is derived from each GAG, constituting a set of linear or circular chromosomes. 
On the global level, genomes are connected to each other along the branches of the phylogeny. Each branch gives rise to a pairwise comparison by means of the CFMRD. 
In doing so, the selection of adjacencies of a derived genome is propagated from across CFMRDs, thus ensuring global consistency. 

\paragraph{Local level.} 
Constraint \ref{c:cn} implements the user-provided copy number requirement. 
In doing so, we define the set of tail extremities of markers from family $i$ in GAG $\ggraph(\X)$ as $F_i = \{ v \mid v \in V: \family(v) = i \text{ and } \extf(v) = \et\}$ and iterate over the associated $\ilpvar{g}$ variables of its members to bound the number of active markers within the given range. 
The choice of counting tail extremities is arbitrary, however, the subsequent constraint (\ref{c:cn_consistent}) ensures that the assignment of $\ilpvar{g}$ variables for both extremities of a markers is consistent. 
At last, Constraint \ref{c:genome} makes sure that a valid genome is derived from the GAG when solving the ILP, by enforcing that each extremity node of $\ggraph(\X)$ is incident to at most one adjacency edge. 

\paragraph{Global level.}

When comparing pairs of genomes within a CFMRD, we make use of a capping-free formulation for the computation of the pairwise DCJ indel distance~\cite{BOH-2023}.


\todoL{Insert a description of the formulation here}

\include{ilp}


\section{Evaluation}
\section{Discussion}



\subsubsection{Acknowledgements} Please place your acknowledgments at
the end of the paper, preceded by an unnumbered run-in heading (i.e.
3rd-level heading).

%
% ---- Bibliography ----
%
% BibTeX users should specify bibliography style 'splncs04'.
% References will then be sorted and formatted in the correct style.
%
\bibliographystyle{splncs04}
\bibliography{refs}


\end{document}
